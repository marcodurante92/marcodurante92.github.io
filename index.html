<!DOCTYPE HTML>
<html>
<head>
   <title>Mobility Survey</title>
</head>
<body bgcolor="#FFFFFF" text="#000000">
   <form action="survey.cgi" method="POST">
Please enter your name:
  <input type="text" id="UserName" size=20 maxlength=50 value="">
  <p>Where is your starting point?:
  <input type="text" id="StartingPoint" size=10 maxlength=50 value=""></p>

<input type="hidden" id="ArrivalPointNA" size=20 maxlength=50 value="Napoli Centrale, Piazza Giuseppe Garibaldi, Napoli, NA">
<input type="hidden" id="ArrivalPointAF" size=20 maxlength=50 value="Stazione Napoli - Afragola, Afragola, NA">
<input type="hidden" id="ArrivalPointSA" size=20 maxlength=50 value="Salerno Stazione, Salerno, SA">

  <p>How much are you far from NAPOLI CENTRALE?:
<input type="text" id="DistanceNA" size=10 maxlength=50 value="">
How much are you far from AFRAGOLA?:
<input type="text" id="DistanceAF" size=10 maxlength=50 value="">
How much are you far from SALERNO?:
<input type="text" id="DistanceSA" size=10 maxlength=50 value=""></p>
<p>
<input type="text" id="TimeNA" size=20 maxlength=50 value="">
<input type="text" id="TimeAF" size=20 maxlength=50 value="">
<input type="text" id="TimeSA" size=20 maxlength=50 value=""></p>

<script>
function generateURL(){
var Start = escape(document.getElementById('StartingPoint').value); //encoda la stringa trasformandola in un valore utilizzabile in un link
var ArrivalNA = escape(document.getElementById('ArrivalPointNA').value);
var ArrivalAF = escape(document.getElementById('ArrivalPointAF').value);
var ArrivalSA = escape(document.getElementById('ArrivalPointSA').value);

var request = new XMLHttpRequest();
request.open('GET',"https://maps.googleapis.com/maps/api/distancematrix/json?origins="+Start+"&destinations="+ArrivalNA+"&departure_time=now&key=AIzaSyAWosGmn8c7dWRi6d5JDiRq8_ZaU-S3Xe4" , true);
request.setRequestHeader('Access-Control-Allow-Origin', '*');
request.onload = function () {
  var data = JSON.parse(this.response); //parse the response, and create a data variable that contains all the JSON as an array of JavaScript objects
  var dist = data.rows[0].elements[0].distance.text; //prendo il primo elemento e seleziono tra le varie caratt. la duration
  var dur = data.rows[0].elements[0].duration.text;
  document.getElementById('DistanceNA').value= dist;
  document.getElementById('TimeNA').value= dur;
  }
  request.send();
//var request1 = new XMLHttpRequest();
//request1.open('GET',"https://maps.googleapis.com/maps/api/distancematrix/json?origins="+Start+"&destinations="+ArrivalNA+"&departure_time=now&key=XXX" , true);
//request1.setRequestHeader('Access-Control-Allow-Origin', '*');
//request1.onload = function () {
//  var data1 = JSON.parse(this.response); //parse the response, and create a data variable that contains all the JSON as an array of JavaScript objects
//  var dur1 = data1.rows[0].elements[0].distance.text; //prendo il primo elemento e seleziono tra le varie caratt. la duration
//  document.getElementById('DistanceAF').value= dur1;
  //}
  //request1.send();
//var request2 = new XMLHttpRequest();
//request2.open('GET',"https://maps.googleapis.com/maps/api/distancematrix/json?origins="+Start+"&destinations="+ArrivalNA+"&departure_time=now&key=XXX" , true);
//request2.setRequestHeader('Access-Control-Allow-Origin', '*');
//request2.onload = function () {
//  var data2 = JSON.parse(this.response); //parse the response, and create a data variable that contains all the JSON as an array of JavaScript objects
//  var dur2 = data2.rows[0].elements[0].distance.text; //prendo il primo elemento e seleziono tra le varie caratt. la duration
//  document.getElementById('DistanceSA').value= dur1;
//  }
//  request2.send();
  }
</script>
<p>
<button type='button' onclick="generateURL()">Calculate Distances</button></p>
   </form>
</body>
</html>
