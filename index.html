<!DOCTYPE html>
<hmtl>

    <head>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <style>
            .container {
            border-radius: 5px;
            background-color: #d0d0d0;
            padding: 10px;
            width:70%;
            }

            input[type=text] {
                width: 30%;
                box-sizing: border-box;
                margin-top: 8px;
                margin-bottom: 8px;
            }

            body {
              font-family: 'Lato', sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <form id="survey-form" onsubmit="event.preventDefault(); return submitSurvey()">
                <fieldset>
                    <legend>Indagine sulla mobilità</legend>
                    <h2> Caratteristiche socio economiche</h2>

                    <p>
                        Età: <INPUT TYPE="Text" NAME="ETA" VALUE="" required>
                    </p>
                    <p>
                        Genere: <INPUT TYPE="RADIO" NAME="GENERE" VALUE="1" required>M
                        <INPUT TYPE="RADIO" NAME="GENERE" VALUE="0" required>F
                    </p>
                    <p>
                        Numero componenti della famiglia <SELECT NAME="MEMBRIFAMIGLIA">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION Name"MEMBRIFAMIGLIA1" VALUE="1">1
                            <OPTION Name"MEMBRIFAMIGLIA2" VALUE="1">2
                            <OPTION Name"MEMBRIFAMIGLIA3" VALUE="1">3
                            <OPTION Name"MEMBRIFAMIGLIA4" VALUE="1">4
                            <OPTION Name"MEMBRIFAMIGLIA5" VALUE="1">5
                            <OPTION Name"MEMBRIFAMIGLIA6" VALUE="1">Più di 5
                        </SELECT>
                        di cui <SELECT NAME="MEMBRIPATENTE">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION VALUE="1">1
                            <OPTION VALUE="1">2
                            <OPTION VALUE="1">3
                            <OPTION VALUE="1">4
                            <OPTION VALUE="1">5
                            <OPTION VALUE="1">Più di 5
                        </SELECT> patentati.
                      </p>
                      <p>Numero di veicoli in famiglia: <SELECT NAME="NUMVEICOLI">
                          <OPTION SELECTED VALUE=""> -
                          <OPTION VALUE="1">0
                          <OPTION VALUE="1">1
                          <OPTION VALUE="1">2
                          <OPTION VALUE="1">Più di 2
                      </SELECT></p>
                    <p>
                        Livello d'istruzione: <SELECT NAME="EDUCAZIONE">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION VALUE="1">Licenzia Media (or equiv.)
                            <OPTION VALUE="1">Diploma (or equiv.)
                            <OPTION VALUE="1">Laurea Triennale
                            <OPTION VALUE="1">Laurea Magistrale
                            <OPTION VALUE="1">Dottorato di ricerca
                        </SELECT></p>
                        <p>
                            Condizione professionale: <SELECT NAME="PROFESSIONE">
                                <OPTION SELECTED VALUE=""> -
                                <OPTION VALUE="1">Studente
                                <OPTION VALUE="1">Casalinga
                                <OPTION VALUE="1">Inoccupato/disoccupato
                                <OPTION VALUE="1">Impiegato
                                <OPTION VALUE="1">Libero professionista
                                <OPTION VALUE="1">Imprenditore
                            </SELECT></p>
                          <p>
                                Condizione professionale capofamiglia: <SELECT NAME="PROFESSIONECF">
                                    <OPTION SELECTED VALUE=""> -
                                    <OPTION VALUE="1">Studente
                                    <OPTION VALUE="1">Casalinga
                                    <OPTION VALUE="1">Inoccupato/disoccupato
                                    <OPTION VALUE="1">Impiegato
                                    <OPTION VALUE="1">Libero professionista
                                    <OPTION VALUE="1">Imprenditore
                                    <OPTION VALUE="1">Pensionato
                                </SELECT></p>
                                <p>
                                    In quale comune risiedi attualmente: <INPUT TYPE="Text" NAME="departure" id="departure-input" VALUE="" required>
                                <p>
                                <hr>
                          <h2>Caratteristiche dello spostamento (Extraregionale)</h2>
                          <p>
                              Hai mai preso l'alta velocità (Frecciarossa/Italo)?: <INPUT TYPE="RADIO" NAME="TRENO" VALUE="1" required>Si
                              <INPUT TYPE="RADIO" NAME="TRENO" VALUE="0" required>No
                          </p>
                          <p>
                              Hai mai preso l'aereo?: <INPUT TYPE="RADIO" NAME="AEREO" VALUE="1" required>Si
                              <INPUT TYPE="RADIO" NAME="AEREO" VALUE="0" required>No
                          </p>
                          <p>
                              In un anno, quanto ti sposti fuori dalla regione?: <p> <INPUT TYPE="RADIO" NAME="SPOSTANN" VALUE="1" required>0-5 volte
                              <INPUT TYPE="RADIO" NAME="SPOSTANN" VALUE="1" required>6-10 volte
                              <INPUT TYPE="RADIO" NAME="SPOSTANN" VALUE="1" required>11-20 volte
                              <INPUT TYPE="RADIO" NAME="SPOSTANN" VALUE="1" required>Più di 21 volte
                          </p>
                          <p>
                              In questi viaggi, quale modo di trasporto usi?: <p><input type="checkbox" name="SCELTAMODO" value="1">Auto<br>
                              <input type="checkbox" name="SCELTAMODO1" value="1">Auto a noleggio<br>
                              <input type="checkbox" name="SCELTAMODO2" value="1">Bus<br>
                              <input type="checkbox" name="SCELTAMODO3" value="1">Treno<br>
                              <input type="checkbox" name="SCELTAMODO4" value="1">Aereo<br>
                              <input type="checkbox" name="SCELTAMODO5" value="1">Carpooling(BLABLA Car)<br></p></p>
                                <p>
                                    Verso che città ti sposti abitualmente?: <INPUT TYPE="Text" NAME="CITTA" VALUE="">
                                </p>
                                <hr>
                                <h2> Percezione Stazione</h2>
                                <p><h3>SCENARIO:</h3>Devi andare a Roma/Milano con il treno ad alta velocità; quale di questi terminal prenderesti in considerazione?</p>
                                <p  style= "font-size:14px"><i>"Clicca e visualizza le distanze"</i>
                                <button type="button" onclick="checkDistances()">Visualizza Distanze</button></p>
                    <div id="departure-list"></div>


                    <p><b>STAZIONE NAPOLI CENTRALE:</b><INPUT TYPE="RADIO" NAME="SceltaStazNa" value="1" onclick="yes();" CHECKED>Si
                    <INPUT TYPE="RADIO" NAME="SceltaStazNa" value="0"onclick="no();">No
                    <BR>
                    <DIV ID="MMDiv" style="display:none">
                    <LABEL FOR="MakeModel">
                    Perchè no?  <p><input type="checkbox" name="ScelteNA" value="1">Non c'ho mai pensato<br>
                    <input type="checkbox" name="ScelteNA1" value="1">E' troppo lontana<br>
                    <input type="checkbox" name="ScelteNA2" value="1">E' mal collegata con i mezzi pubblici<br>
                    <input type="checkbox" name="ScelteNA3" value="1">E' poco sicura<br>
                    <input type="checkbox" name="ScelteNA4" value="1">Ha pochi servizi commerciali e di ristorazione<br>
                    <input type="checkbox" name="ScelteNA5" value="1">E' difficile/costoso parcheggiare<br>
                    <input type="checkbox" ID="AltroNA-id" name="ScelteNA6" value="1"  onclick="altroNa();">Altro<br>
                    <input type="text" name=AltroNA value"" ID="TextAltroNA" style="display:none">
                  </p></LABEL></div>

                    <script>
                   function altroNa() {
                   if ($("#AltroNA-id").is(":checked")){
                   $("#TextAltroNA").css("display", "block");
                   } else {
                     $("#TextAltroNA").css("display", "none");
                   }
                   }

                    function no() {
                     MMDiv.style.display='block';
                    }
                    function yes() {
                     MMDiv.style.display='none';
                   }
                 </script>

                   <p><b>STAZIONE AFRAGOLA:</b><INPUT TYPE="RADIO" NAME="SceltaStazAf" value="1" onclick="yes1();" CHECKED>Si
                   <INPUT TYPE="RADIO" NAME="SceltaStazAf" value="0"onclick="no1();">No
                   <BR>
                   <DIV ID="MMDiv1" style="display:none">
                   <LABEL FOR="MakeModel1">
                   Perchè no?  <p><input type="checkbox" name="ScelteAF" value="1">Non c'ho mai pensato<br>
                   <input type="checkbox" name="ScelteAF1" value="1">E' troppo lontana<br>
                   <input type="checkbox" name="ScelteAF2" value="1">E' mal collegata con i mezzi pubblici<br>
                   <input type="checkbox" name="ScelteAF3" value="1">E' poco sicura<br>
                   <input type="checkbox" name="ScelteAF4" value="1">Ha pochi servizi commerciali e di ristorazione<br>
                   <input type="checkbox" name="ScelteAF5" value="1">E' difficile/costoso parcheggiare<br>
                   <input type="checkbox" ID="AltroAF-id" name="ScelteAF6" value="1"  onclick="altroAf();">Altro<br>
                   <input type="text" name=AltroAF value"" ID="TextAltroAF" style="display:none">
                 </p></LABEL></div>

                   <script>
                   function altroAf() {
                   if ($("#AltroAF-id").is(":checked")){
                   $("#TextAltroAF").css("display", "block");
                   } else {
                     $("#TextAltroAF").css("display", "none");
                   }
                   }

                   function no1() {
                    MMDiv1.style.display='block';
                   }
                   function yes1() {
                    MMDiv1.style.display='none';
                  }</script>

                  <p><b>STAZIONE SALERNO:</b><INPUT TYPE="RADIO" NAME="SceltaStazSa" value="1" onclick="yes2();" CHECKED>Si
                  <INPUT TYPE="RADIO" NAME="SceltaStazSa" value="0" onclick="no2();">No
                  <BR>
                  <DIV ID="MMDiv2" style="display:none">
                  <LABEL FOR="MakeModel2">
                  Perchè no?  <p><input type="checkbox" name="ScelteSA" value="1">Non c'ho mai pensato<br>
                  <input type="checkbox" name="ScelteSA1" value="1">E' troppo lontana<br>
                  <input type="checkbox" name="ScelteSA2" value="1">E' mal collegata con i mezzi pubblici<br>
                  <input type="checkbox" name="ScelteSA3" value="1">E' poco sicura<br>
                  <input type="checkbox" name="ScelteSA4" value="1">Ha pochi servizi commerciali e di ristorazione<br>
                  <input type="checkbox" name="ScelteSA5" value="1">E' difficile/costoso parcheggiare<br>
                  <input type="checkbox" ID="AltroSA-id" name="ScelteSA6" value="1"  onclick="altroSa();">Altro<br>
                  <input type="text" name=AltroSA value"" ID="TextAltroSA" style="display:none">
                </p></LABEL></div>

                  <script>
                  function altroSa() {
                  if ($("#AltroSA-id").is(":checked")){
                  $("#TextAltroSA").css("display", "block");
                  } else {
                    $("#TextAltroSA").css("display", "none");
                  }
                  }

                  function no2() {
                   MMDiv2.style.display='block';
                  }
                  function yes2() {
                   MMDiv2.style.display='none';
                  }</script>

                        <p>
                            <button type="submit" style="display: none" id="form-btn">Invia</button></p>
                </fieldset>

            </form>

        </div>

        <script>
            var distances = null;

            function checkDistances() {
                var departure = $("#departure-input").val(); //recupera l'elemento con id (#) uguale a 'departure-input'

                //Crea la chiamata ajax al server per recuperare la lista di distanze
                $.post('https://marcos-survey-pr-1550269884833.firebaseapp.com/api', {
                        from: departure
                    })
                    .then(function (response) {
                        distances = response.distances;
                        console.log(distances);
                        var list = "";
                        $.each(distances, function (i, element) {
                            list = list + "<li>To <b>" + element.destination + "</b> (distance: " + element
                                .distance.text + " - duration: " + element.duration.text + ")</li>"
                        })
                        $("#departure-list").empty()
                        $("#departure-list").append("<ul>" +
                            list +
                            "</ul>");
                        $("#form-btn").css("display", "block");
                    })
            }

            function submitSurvey() {
                var elements = $("#survey-form").serializeArray();
                var json = {};

                $.each(elements, function (i, input) {
                    json[input.name] = input.value;
                });
                console.log(json);
                var data = Object.assign({
                    distances: distances
                }, json);
                console.log(data);

                $.post('https://marcos-survey-pr-1550269884833.firebaseapp.com/api/confirmSurvey',
                        data)
                    .then(response => {
                        alert(response.message);
                    })
                return false;
            }


        </script>
    </body>
</hmtl>
