<!DOCTYPE html>
<hmtl>

    <head>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <style>
            .container {
            border-radius: 5px;
            background-color: #d0d0d0;
            padding: 10px;
            width:70%;
            }

            input[type=text] {
                width: 30%;
                box-sizing: border-box;
                margin-top: 8px;
                margin-bottom: 8px;
            }

            body {
              font-family: 'Lato', sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <form id="survey-form" onsubmit="event.preventDefault(); return submitSurvey()">
                <fieldset>
                    <legend>Indagine sulla mobilità</legend>
                    <h2> Caratteristiche socio economiche</h2>
                    <p>
                        Età: <INPUT TYPE="Text" NAME="age" VALUE="" required>
                    </p>
                    <p>
                        Genere: <INPUT TYPE="RADIO" NAME="gender" VALUE="M" required>M
                        <INPUT TYPE="RADIO" NAME="gender" VALUE="F" required>F
                    </p>
                    <p>
                        Numero componenti della famiglia <SELECT NAME="family-members">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION VALUE="1">1
                            <OPTION VALUE="2">2
                            <OPTION VALUE="3">3
                            <OPTION VALUE="4">4
                            <OPTION VALUE="5">5
                            <OPTION VALUE="6+">6 or +
                        </SELECT>
                        di cui <SELECT NAME="members-with-licence">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION VALUE="1">1
                            <OPTION VALUE="2">2
                            <OPTION VALUE="3">3
                            <OPTION VALUE="4">4
                            <OPTION VALUE="5">5
                            <OPTION VALUE="6+">6 or +
                        </SELECT> patentati.
                      </p>
                      <p>Numero di veicoli in famiglia: <SELECT NAME="members-veichle">
                          <OPTION SELECTED VALUE=""> -
                          <OPTION VALUE="0">0
                          <OPTION VALUE="2">1
                          <OPTION VALUE="2">2
                          <OPTION VALUE="3+">3 or +
                      </SELECT></p>
                    <p>
                        In quale comune risiedi attualmente: <INPUT TYPE="Text" NAME="departure" id="departure-input" VALUE="" required>
                    <p>
                        Livello d'istruzione: <SELECT NAME="educazione">
                            <OPTION SELECTED VALUE=""> -
                            <OPTION VALUE="Media">Licenzia Media (or equiv.)
                            <OPTION VALUE="Diploma">Diploma (or equiv.)
                            <OPTION VALUE="Bachelor">Laurea Triennale
                            <OPTION VALUE="Master">Laurea Magistrale
                            <OPTION VALUE="Doctoral">Dottorato di ricerca
                        </SELECT></p>
                        <p>
                            Condizione professionale: <SELECT NAME="professione">
                                <OPTION SELECTED VALUE=""> -
                                <OPTION VALUE="Studente">Studente
                                <OPTION VALUE="Casalinga">Casalinga
                                <OPTION VALUE="Inoccupato/disoccupato">Inoccupato/disoccupato
                                <OPTION VALUE="Impiegato">Impiegato
                                <OPTION VALUE="Libero professionista">Libero professionista
                                <OPTION VALUE="Imprenditore">Imprenditore
                            </SELECT></p>
                          <p>
                                Condizione professionale capofamiglia: <SELECT NAME="professione-capofamiglia">
                                    <OPTION SELECTED VALUE=""> -
                                    <OPTION VALUE="Studente">Studente
                                    <OPTION VALUE="Casalinga">Casalinga
                                    <OPTION VALUE="Inoccupato/disoccupato">Inoccupato/disoccupato
                                    <OPTION VALUE="Impiegato">Impiegato
                                    <OPTION VALUE="Libero professionista">Libero professionista
                                    <OPTION VALUE="Imprenditore">Imprenditore
                                </SELECT></p>
                                <hr>
                          <h2> Comportamento spostamento</h2>
                          <p>
                              Hai mai preso la TAV(Frecciarossa/Italo)?: <INPUT TYPE="RADIO" NAME="Tav" VALUE="Si" required>Si
                              <INPUT TYPE="RADIO" NAME="Tav" VALUE="No" required>No
                          </p>
                          <p>
                              Hai mai preso l'aereo?: <INPUT TYPE="RADIO" NAME="Aereo" VALUE="Si" required>Si
                              <INPUT TYPE="RADIO" NAME="Aereo" VALUE="No" required>No
                          </p>
                          <p>
                              Numero di spostamenti EXTRAREGIONE in un anno ?: <INPUT TYPE="RADIO" NAME="spost-annuali" VALUE="0/5" required>0/5
                              <INPUT TYPE="RADIO" NAME="spost-annuali" VALUE="6/10" required>6/10
                              <INPUT TYPE="RADIO" NAME="spost-annuali" VALUE="11/20" required>11/20
                              <INPUT TYPE="RADIO" NAME="spost-annuali" VALUE="21+" required>21+
                          </p>
                          <p>
                                Modo usualmente utilizzato?: <SELECT NAME="modo-spost-annuali">
                                    <OPTION SELECTED VALUE=""> -
                                    <OPTION VALUE="Auto">Auto
                                    <OPTION VALUE="Bus">Bus
                                    <OPTION VALUE="Treno">Treno
                                    <OPTION VALUE="Aereo">Aereo
                                    <OPTION VALUE="Carpooling">Carpooling(BLABLA CAR)
                                </SELECT></p>
                                <p>
                                    Verso che città ti sposti abitualmente?: <INPUT TYPE="Text" NAME="città" VALUE="">
                                </p>
                                <hr>
                                <h2> Percezione HUB</h2>
                                <p><h3>SCENARIO:</h3>Devi andare a Roma/Milano con la TAV; quale di questi nodi prenderesti in considerazione?</p>
                                <div><i>"Cliccando è possibile mostrare le distanze dall'attuale residenza ai diversi hub"</i></div>
                                <p>
                    <button type="button" onclick="checkDistances()">Visualizza Distanze</button>
                    <div id="departure-list"></div></p>
                    <p><b>STAZIONE NAPOLI CENTRALE:</b><INPUT TYPE="RADIO" NAME="scelta-Na" value="Si" onclick="yes();" CHECKED>Si
                    <INPUT TYPE="RADIO" NAME="scelta-Na" value="No"onclick="no();">No
                    <BR>
                    <DIV ID="MMDiv" style="display:none">
                    <LABEL FOR="MakeModel">
                    Perchè no?  <input type="checkbox" name="ScelteNA" value="Mai-Pensato">Non c'ho mai pensato<br>
                    <input type="checkbox" name="ScelteNA" value="Lontanza">E' troppo lontana<br>
                    <input type="checkbox" name="ScelteNA" value="Costo">Il biglietto cosa troppo<br>
                    <input type="checkbox" name="ScelteNA" value="Corse">Ci sono poche corse<br>
                    <input type="checkbox" name="ScelteNA" value="Collegamenti">E' mal collegata con i mezzi pubbl.<br>
                    <input type="checkbox" name="ScelteNA" value="Sicurezza">E' poco sicura<br>
                    <input type="checkbox" name="ScelteNA" value="Servizi">Ha pochi servizi comm. e di rist.<br>
                    <input type="checkbox" name="ScelteNA" value="Parcheggio">E' difficile/costoso parcheggiare<br>
                    <input type="checkbox" name="ScelteNA" value="Altro">Altro<br>
                    </LABEL></div>

                    <script>
                    function no() {
                     MMDiv.style.display='block'; mainform2.MakeModel.focus();
                    }
                    function yes() {
                     MMDiv.style.display='none';
                   }</script>

                   <p><b>STAZIONE AFRAGOLA:</b><INPUT TYPE="RADIO" NAME="scelta-AF" value="Si" onclick="yes1();" CHECKED>Si
                   <INPUT TYPE="RADIO" NAME="scelta-AF" value="No"onclick="no1();">No
                   <BR>
                   <DIV ID="MMDiv1" style="display:none">
                   <LABEL FOR="MakeModel1">
                   Perchè no?  <input type="checkbox" name="ScelteAF" value="Mai-Pensato">Non c'ho mai pensato<br>
                   <input type="checkbox" name="ScelteAF" value="Lontanza">E' troppo lontana<br>
                   <input type="checkbox" name="ScelteAF" value="Costo">Il biglietto cosa troppo<br>
                   <input type="checkbox" name="ScelteAF" value="Corse">Ci sono poche corse<br>
                   <input type="checkbox" name="ScelteAF" value="Collegamenti">E' mal collegata con i mezzi pubbl.<br>
                   <input type="checkbox" name="ScelteAF" value="Sicurezza">E' poco sicura<br>
                   <input type="checkbox" name="ScelteAF" value="Servizi">Ha pochi servizi comm. e di rist.<br>
                   <input type="checkbox" name="ScelteAF" value="Parcheggio">E' difficile/costoso parcheggiare<br>
                   <input type="checkbox" name="ScelteAF" value="Altro">Altro<br>
                   </LABEL></div>

                   <script>
                   function no1() {
                    MMDiv1.style.display='block'; mainform2.MakeModel1.focus();
                   }
                   function yes1() {
                    MMDiv1.style.display='none';
                  }</script>

                  <p><b>STAZIONE SALERNO:</b><INPUT TYPE="RADIO" NAME="scelta-SA" value="Si" onclick="yes2();" CHECKED>Si
                  <INPUT TYPE="RADIO" NAME="scelta-SA" value="No"onclick="no2();">No
                  <BR>
                  <DIV ID="MMDiv2" style="display:none">
                  <LABEL FOR="MakeModel2">
                  Perchè no?  <input type="checkbox" name="ScelteSA" value="Mai-Pensato">Non c'ho mai pensato<br>
                  <input type="checkbox" name="ScelteSA" value="Lontanza">E' troppo lontana<br>
                  <input type="checkbox" name="ScelteSA" value="Costo">Il biglietto cosa troppo<br>
                  <input type="checkbox" name="ScelteSA" value="Corse">Ci sono poche corse<br>
                  <input type="checkbox" name="ScelteSA" value="Collegamenti">E' mal collegata con i mezzi pubbl.<br>
                  <input type="checkbox" name="ScelteSA" value="Sicurezza">E' poco sicura<br>
                  <input type="checkbox" name="ScelteSA" value="Servizi">Ha pochi servizi comm. e di rist.<br>
                  <input type="checkbox" name="ScelteSA" value="Parcheggio">E' difficile/costoso parcheggiare<br>
                  <input type="checkbox" name="ScelteSA" value="Altro">Altro<br>
                  </LABEL></div>

                  <script>
                  function no2() {
                   MMDiv2.style.display='block'; mainform2.MakeModel2.focus();
                  }
                  function yes2() {
                   MMDiv2.style.display='none';
                  }</script>

                        <p>
                            <button type="submit" style="display: none" id="form-btn">Invia</button></p>
                </fieldset>

            </form>

        </div>

        <script>
            var distances = null;

            function checkDistances() {
                var departure = $("#departure-input").val(); //recupera l'elemento con id (#) uguale a 'departure-input'

                //Crea la chiamata ajax al server per recuperare la lista di distanze
                $.post('https://marcos-survey-pr-1550269884833.firebaseapp.com/api', {
                        from: departure
                    })
                    .then(function (response) {
                        distances = response.distances;
                        console.log(distances);
                        var list = "";
                        $.each(distances, function (i, element) {
                            list = list + "<li>To <b>" + element.destination + "</b> (distance: " + element
                                .distance.text + " - duration: " + element.duration.text + ")</li>"
                        })
                        $("#departure-list").empty()
                        $("#departure-list").append("<ul>" +
                            list +
                            "</ul>");
                        $("#form-btn").css("display", "block");
                    })
            }

            function submitSurvey() {
                var elements = $("#survey-form").serializeArray();
                var json = {};

                $.each(elements, function (i, input) {
                    json[input.name] = input.value;
                });
                console.log(json);
                var data = Object.assign({
                    distances: distances
                }, json);
                console.log(data);

                $.post('https://marcos-survey-pr-1550269884833.firebaseapp.com/api/confirmSurvey',
                        data)
                    .then(response => {
                        alert(response.message);
                    })
                return false;
            }


        </script>
    </body>
</hmtl>
